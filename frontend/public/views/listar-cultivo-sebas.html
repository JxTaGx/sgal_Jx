<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/pages/listar-ciclo-cultivo-sebas-style.css">
    <title>Listar Cultivos</title>
</head>
<body>
    <h1>Listar Cultivos</h1>
    <img src="/frontend/IMG/logo-sena.png" alt="Logo SENA" class="header__logo">
    
    <div class="header">
        <input type="text" placeholder="Buscar cultivos..." class="header__search">
        <input type="submit" class="button button--green" value="Filtrar">
        <div>
            <a href="../views/excel.html">
                <input class="button button--gray" type="submit" value="Generar Reporte">
            </a>
        </div>
    </div>

    <main>
        <div class="main__container">
            <div id="cards" class="cards">
                <!-- Aquí se insertarán las tarjetas dinámicamente -->
            </div>
        </div>

        <div class="footer">
            <div class="footer__buttons">
                <a href="../views/home.html">
                    <input type="submit" class="button button--return" value="Volver">
                </a>
            </div>
            <div class="footer__pagination">
                <button class="pagination__button">1</button>
                <button class="pagination__button">2</button>
                <button class="pagination__button">3</button>
            </div>
            <div class="footer__buttons">
                <a href="create-cultivo.html">
                    <input type="submit" class="button button--crear" value="Crear Cultivo">
                </a>
            </div>
        </div>
    </main>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        fetch('http://localhost:3000/cultivos')
            .then(response => response.json())
            .then(data => {
                const cardsContainer = document.getElementById('cards');
                cardsContainer.innerHTML = '';

                data.forEach(cultivo => {
                    console.log(cultivo); 

                    const id = cultivo.id_cultivo || cultivo.id;
                    const card = document.createElement('div');
                    card.classList.add('card');
                    card.innerHTML = `
                        <h3 class="card__title">${cultivo.nombre_cultivo}</h3>
                        <p class="card__info">Tipo: ${cultivo.tipo_cultivo}</p>
                        <p class="card__info">Ubicación: ${cultivo.ubicacion}</p>
                        <p class="card__info">Estado: ${cultivo.estado}</p>
                        <input type="submit" class="card__button" value="Ver detalles" onclick="visualizarCultivo('${id}')">
                    `;
                    cardsContainer.appendChild(card);
                });
            })
            .catch(error => {
                console.error('Error al listar cultivos:', error);
            });
    });

    function visualizarCultivo(id) {
        localStorage.setItem('idCultivo', id);
        window.location.href = 'visualizar-cultivo.html';
    }

    function editarCultivo(id) {
        localStorage.setItem('idCultivo', id);
        window.location.href = 'actualizar-cultivo.html';
    }
    </script>
    <script src="/frontend/public/js/pages/listar-ciclo-cultivo.js"></script>
</body>
</html>
